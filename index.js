(function(e, a) { for(var i in a) e[i] = a[i]; }(exports, /******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, {
/******/ 				configurable: false,
/******/ 				enumerable: true,
/******/ 				get: getter
/******/ 			});
/******/ 		}
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = 2);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar ModelAttribute = /** @class */ (function () {\n    function ModelAttribute(name, type) {\n        if (type === void 0) { type = 'string'; }\n        this.name = name;\n        this.type = type;\n    }\n    ModelAttribute.prototype.init = function (model) {\n        var _this = this;\n        if (model.className === 'FooChild' && this.name === 'foo') {\n            console.error('z', model.className, this.name, model.hasOwnProperty(this.name), model[this.name]);\n            throw new Error('asd');\n        }\n        if (!model.hasOwnProperty(this.name)) {\n            Object.defineProperty(model, this.name, {\n                get: function () { return model.getAttribute(_this.name); },\n                set: function (value) {\n                    model.setAttribute(_this.name, value);\n                },\n            });\n        }\n    };\n    return ModelAttribute;\n}());\nexports.ModelAttribute = ModelAttribute;\nvar Model = /** @class */ (function () {\n    function Model(values, attributes) {\n        if (attributes === void 0) { attributes = []; }\n        this._values = {};\n        this._class = this.constructor; //@todo: can be removed ?!\n        this._class.addAttributes(attributes);\n        this._initAttributes();\n        if (values) {\n            this.attributes = values;\n        }\n    }\n    Model.addAttributes = function (attributes) {\n        var _this = this;\n        attributes.forEach(function (attribute) {\n            var found = false, index = null;\n            _this._attributes.forEach(function (attr, i) {\n                if (attribute.name === attr.name) {\n                    index = i;\n                    found = true;\n                }\n            });\n            if (found) {\n                _this._attributes[index] = attribute;\n            }\n            else {\n                _this._attributes.push(attribute);\n            }\n        });\n    };\n    Model.hasAttribute = function (attribute) {\n        var found = false;\n        this._attributes.forEach(function (attr, i) {\n            if (attribute === attr.name) {\n                found = true;\n            }\n        });\n        return found;\n    };\n    Model.prototype.hasAttribute = function (attribute) {\n        return this._class.hasAttribute(attribute);\n    };\n    Object.defineProperty(Model.prototype, \"class\", {\n        get: function () {\n            return this._class;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Model, \"className\", {\n        get: function () {\n            return this.name;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Model.prototype, \"className\", {\n        get: function () {\n            return this._class.name;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Model.prototype._initAttributes = function () {\n        var _this = this;\n        this._class._attributes.forEach(function (attribute) { return attribute.init(_this); });\n    };\n    Model.defineAttributes = function (attributes) {\n        this._attributes = attributes;\n    };\n    Model.getAttributeDefinition = function () {\n        return this._attributes;\n    };\n    Model.prototype.setAttributes = function (values) {\n        var keys = Object.keys(values);\n        for (var i = 0, l = keys.length; i < l; i++) {\n            this._values[keys[i]] = values[keys[i]];\n        }\n    };\n    Object.defineProperty(Model.prototype, \"attributes\", {\n        get: function () {\n            return this._values;\n        },\n        set: function (values) {\n            this.setAttributes(values);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Model.prototype.setAttribute = function (attribute, value) {\n        this._values[attribute] = value;\n    };\n    Model.prototype.getAttribute = function (attribute) {\n        return this._values[attribute];\n    };\n    Model._attributes = [];\n    return Model;\n}());\nexports.Model = Model;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMC5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL3NyYy9Nb2RlbC50cz9lNmMwIl0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIE1vZGVsQXR0cmlidXRlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIE1vZGVsQXR0cmlidXRlKG5hbWUsIHR5cGUpIHtcbiAgICAgICAgaWYgKHR5cGUgPT09IHZvaWQgMCkgeyB0eXBlID0gJ3N0cmluZyc7IH1cbiAgICAgICAgdGhpcy5uYW1lID0gbmFtZTtcbiAgICAgICAgdGhpcy50eXBlID0gdHlwZTtcbiAgICB9XG4gICAgTW9kZWxBdHRyaWJ1dGUucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbiAobW9kZWwpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgaWYgKG1vZGVsLmNsYXNzTmFtZSA9PT0gJ0Zvb0NoaWxkJyAmJiB0aGlzLm5hbWUgPT09ICdmb28nKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCd6JywgbW9kZWwuY2xhc3NOYW1lLCB0aGlzLm5hbWUsIG1vZGVsLmhhc093blByb3BlcnR5KHRoaXMubmFtZSksIG1vZGVsW3RoaXMubmFtZV0pO1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdhc2QnKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIW1vZGVsLmhhc093blByb3BlcnR5KHRoaXMubmFtZSkpIHtcbiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShtb2RlbCwgdGhpcy5uYW1lLCB7XG4gICAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7IHJldHVybiBtb2RlbC5nZXRBdHRyaWJ1dGUoX3RoaXMubmFtZSk7IH0sXG4gICAgICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgbW9kZWwuc2V0QXR0cmlidXRlKF90aGlzLm5hbWUsIHZhbHVlKTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHJldHVybiBNb2RlbEF0dHJpYnV0ZTtcbn0oKSk7XG5leHBvcnRzLk1vZGVsQXR0cmlidXRlID0gTW9kZWxBdHRyaWJ1dGU7XG52YXIgTW9kZWwgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gTW9kZWwodmFsdWVzLCBhdHRyaWJ1dGVzKSB7XG4gICAgICAgIGlmIChhdHRyaWJ1dGVzID09PSB2b2lkIDApIHsgYXR0cmlidXRlcyA9IFtdOyB9XG4gICAgICAgIHRoaXMuX3ZhbHVlcyA9IHt9O1xuICAgICAgICB0aGlzLl9jbGFzcyA9IHRoaXMuY29uc3RydWN0b3I7IC8vQHRvZG86IGNhbiBiZSByZW1vdmVkID8hXG4gICAgICAgIHRoaXMuX2NsYXNzLmFkZEF0dHJpYnV0ZXMoYXR0cmlidXRlcyk7XG4gICAgICAgIHRoaXMuX2luaXRBdHRyaWJ1dGVzKCk7XG4gICAgICAgIGlmICh2YWx1ZXMpIHtcbiAgICAgICAgICAgIHRoaXMuYXR0cmlidXRlcyA9IHZhbHVlcztcbiAgICAgICAgfVxuICAgIH1cbiAgICBNb2RlbC5hZGRBdHRyaWJ1dGVzID0gZnVuY3Rpb24gKGF0dHJpYnV0ZXMpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgYXR0cmlidXRlcy5mb3JFYWNoKGZ1bmN0aW9uIChhdHRyaWJ1dGUpIHtcbiAgICAgICAgICAgIHZhciBmb3VuZCA9IGZhbHNlLCBpbmRleCA9IG51bGw7XG4gICAgICAgICAgICBfdGhpcy5fYXR0cmlidXRlcy5mb3JFYWNoKGZ1bmN0aW9uIChhdHRyLCBpKSB7XG4gICAgICAgICAgICAgICAgaWYgKGF0dHJpYnV0ZS5uYW1lID09PSBhdHRyLm5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgaW5kZXggPSBpO1xuICAgICAgICAgICAgICAgICAgICBmb3VuZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBpZiAoZm91bmQpIHtcbiAgICAgICAgICAgICAgICBfdGhpcy5fYXR0cmlidXRlc1tpbmRleF0gPSBhdHRyaWJ1dGU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBfdGhpcy5fYXR0cmlidXRlcy5wdXNoKGF0dHJpYnV0ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgTW9kZWwuaGFzQXR0cmlidXRlID0gZnVuY3Rpb24gKGF0dHJpYnV0ZSkge1xuICAgICAgICB2YXIgZm91bmQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5fYXR0cmlidXRlcy5mb3JFYWNoKGZ1bmN0aW9uIChhdHRyLCBpKSB7XG4gICAgICAgICAgICBpZiAoYXR0cmlidXRlID09PSBhdHRyLm5hbWUpIHtcbiAgICAgICAgICAgICAgICBmb3VuZCA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gZm91bmQ7XG4gICAgfTtcbiAgICBNb2RlbC5wcm90b3R5cGUuaGFzQXR0cmlidXRlID0gZnVuY3Rpb24gKGF0dHJpYnV0ZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5fY2xhc3MuaGFzQXR0cmlidXRlKGF0dHJpYnV0ZSk7XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoTW9kZWwucHJvdG90eXBlLCBcImNsYXNzXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fY2xhc3M7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShNb2RlbCwgXCJjbGFzc05hbWVcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm5hbWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShNb2RlbC5wcm90b3R5cGUsIFwiY2xhc3NOYW1lXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fY2xhc3MubmFtZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgTW9kZWwucHJvdG90eXBlLl9pbml0QXR0cmlidXRlcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdGhpcy5fY2xhc3MuX2F0dHJpYnV0ZXMuZm9yRWFjaChmdW5jdGlvbiAoYXR0cmlidXRlKSB7IHJldHVybiBhdHRyaWJ1dGUuaW5pdChfdGhpcyk7IH0pO1xuICAgIH07XG4gICAgTW9kZWwuZGVmaW5lQXR0cmlidXRlcyA9IGZ1bmN0aW9uIChhdHRyaWJ1dGVzKSB7XG4gICAgICAgIHRoaXMuX2F0dHJpYnV0ZXMgPSBhdHRyaWJ1dGVzO1xuICAgIH07XG4gICAgTW9kZWwuZ2V0QXR0cmlidXRlRGVmaW5pdGlvbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2F0dHJpYnV0ZXM7XG4gICAgfTtcbiAgICBNb2RlbC5wcm90b3R5cGUuc2V0QXR0cmlidXRlcyA9IGZ1bmN0aW9uICh2YWx1ZXMpIHtcbiAgICAgICAgdmFyIGtleXMgPSBPYmplY3Qua2V5cyh2YWx1ZXMpO1xuICAgICAgICBmb3IgKHZhciBpID0gMCwgbCA9IGtleXMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgICAgICB0aGlzLl92YWx1ZXNba2V5c1tpXV0gPSB2YWx1ZXNba2V5c1tpXV07XG4gICAgICAgIH1cbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShNb2RlbC5wcm90b3R5cGUsIFwiYXR0cmlidXRlc1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3ZhbHVlcztcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWVzKSB7XG4gICAgICAgICAgICB0aGlzLnNldEF0dHJpYnV0ZXModmFsdWVzKTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgTW9kZWwucHJvdG90eXBlLnNldEF0dHJpYnV0ZSA9IGZ1bmN0aW9uIChhdHRyaWJ1dGUsIHZhbHVlKSB7XG4gICAgICAgIHRoaXMuX3ZhbHVlc1thdHRyaWJ1dGVdID0gdmFsdWU7XG4gICAgfTtcbiAgICBNb2RlbC5wcm90b3R5cGUuZ2V0QXR0cmlidXRlID0gZnVuY3Rpb24gKGF0dHJpYnV0ZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5fdmFsdWVzW2F0dHJpYnV0ZV07XG4gICAgfTtcbiAgICBNb2RlbC5fYXR0cmlidXRlcyA9IFtdO1xuICAgIHJldHVybiBNb2RlbDtcbn0oKSk7XG5leHBvcnRzLk1vZGVsID0gTW9kZWw7XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3NyYy9Nb2RlbC50c1xuLy8gbW9kdWxlIGlkID0gMFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///0\n");

/***/ }),
/* 1 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar ActiveQuery = /** @class */ (function () {\n    function ActiveQuery(model) {\n        this._params = {\n            fields: [],\n            limit: {\n                start: 0,\n                end: undefined\n            },\n            sort: [],\n            where: {},\n        };\n        model.init();\n        this._db = model.db;\n        this._model = model;\n    }\n    Object.defineProperty(ActiveQuery.prototype, \"params\", {\n        get: function () {\n            return this._params;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ActiveQuery.prototype, \"db\", {\n        get: function () {\n            return this._db;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ActiveQuery.prototype, \"model\", {\n        get: function () {\n            return this._model;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    ActiveQuery.prototype.fields = function (param) {\n        var fields = param;\n        if (param.constructor.name === 'string') {\n            fields = [param];\n        }\n        this._params.fields = fields;\n        return this;\n    };\n    ActiveQuery.prototype.sort = function (param) {\n        var sort = param;\n        if (param.constructor.name === 'string') {\n            sort = [param];\n        }\n        this._params.sort = sort;\n        return this;\n    };\n    ActiveQuery.prototype.limit = function (start, end) {\n        if (start === void 0) { start = 0; }\n        if (end === void 0) { end = null; }\n        this._params.limit.start = start;\n        this._params.limit.end = end;\n        return this;\n    };\n    ActiveQuery.prototype.where = function (condition) {\n        if (condition === void 0) { condition = {}; }\n        this._params.where = condition;\n        return this;\n    };\n    return ActiveQuery;\n}());\nexports.ActiveQuery = ActiveQuery;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMS5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL3NyYy9BY3RpdmVRdWVyeS50cz83MTIxIl0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIEFjdGl2ZVF1ZXJ5ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIEFjdGl2ZVF1ZXJ5KG1vZGVsKSB7XG4gICAgICAgIHRoaXMuX3BhcmFtcyA9IHtcbiAgICAgICAgICAgIGZpZWxkczogW10sXG4gICAgICAgICAgICBsaW1pdDoge1xuICAgICAgICAgICAgICAgIHN0YXJ0OiAwLFxuICAgICAgICAgICAgICAgIGVuZDogdW5kZWZpbmVkXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc29ydDogW10sXG4gICAgICAgICAgICB3aGVyZToge30sXG4gICAgICAgIH07XG4gICAgICAgIG1vZGVsLmluaXQoKTtcbiAgICAgICAgdGhpcy5fZGIgPSBtb2RlbC5kYjtcbiAgICAgICAgdGhpcy5fbW9kZWwgPSBtb2RlbDtcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEFjdGl2ZVF1ZXJ5LnByb3RvdHlwZSwgXCJwYXJhbXNcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9wYXJhbXM7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShBY3RpdmVRdWVyeS5wcm90b3R5cGUsIFwiZGJcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9kYjtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEFjdGl2ZVF1ZXJ5LnByb3RvdHlwZSwgXCJtb2RlbFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX21vZGVsO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBBY3RpdmVRdWVyeS5wcm90b3R5cGUuZmllbGRzID0gZnVuY3Rpb24gKHBhcmFtKSB7XG4gICAgICAgIHZhciBmaWVsZHMgPSBwYXJhbTtcbiAgICAgICAgaWYgKHBhcmFtLmNvbnN0cnVjdG9yLm5hbWUgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICBmaWVsZHMgPSBbcGFyYW1dO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3BhcmFtcy5maWVsZHMgPSBmaWVsZHM7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG4gICAgQWN0aXZlUXVlcnkucHJvdG90eXBlLnNvcnQgPSBmdW5jdGlvbiAocGFyYW0pIHtcbiAgICAgICAgdmFyIHNvcnQgPSBwYXJhbTtcbiAgICAgICAgaWYgKHBhcmFtLmNvbnN0cnVjdG9yLm5hbWUgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICBzb3J0ID0gW3BhcmFtXTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9wYXJhbXMuc29ydCA9IHNvcnQ7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG4gICAgQWN0aXZlUXVlcnkucHJvdG90eXBlLmxpbWl0ID0gZnVuY3Rpb24gKHN0YXJ0LCBlbmQpIHtcbiAgICAgICAgaWYgKHN0YXJ0ID09PSB2b2lkIDApIHsgc3RhcnQgPSAwOyB9XG4gICAgICAgIGlmIChlbmQgPT09IHZvaWQgMCkgeyBlbmQgPSBudWxsOyB9XG4gICAgICAgIHRoaXMuX3BhcmFtcy5saW1pdC5zdGFydCA9IHN0YXJ0O1xuICAgICAgICB0aGlzLl9wYXJhbXMubGltaXQuZW5kID0gZW5kO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xuICAgIEFjdGl2ZVF1ZXJ5LnByb3RvdHlwZS53aGVyZSA9IGZ1bmN0aW9uIChjb25kaXRpb24pIHtcbiAgICAgICAgaWYgKGNvbmRpdGlvbiA9PT0gdm9pZCAwKSB7IGNvbmRpdGlvbiA9IHt9OyB9XG4gICAgICAgIHRoaXMuX3BhcmFtcy53aGVyZSA9IGNvbmRpdGlvbjtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbiAgICByZXR1cm4gQWN0aXZlUXVlcnk7XG59KCkpO1xuZXhwb3J0cy5BY3RpdmVRdWVyeSA9IEFjdGl2ZVF1ZXJ5O1xuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9zcmMvQWN0aXZlUXVlcnkudHNcbi8vIG1vZHVsZSBpZCA9IDFcbi8vIG1vZHVsZSBjaHVua3MgPSAwIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///1\n");

/***/ }),
/* 2 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\nfunction __export(m) {\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n}\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__export(__webpack_require__(1));\n__export(__webpack_require__(3));\n__export(__webpack_require__(4));\n__export(__webpack_require__(0));\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMi5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL3NyYy9pbmRleC50cz9lOWNmIl0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuL0FjdGl2ZVF1ZXJ5XCIpKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuL0FjdGl2ZVJlY29yZFwiKSk7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi9BY3RpdmVSZWNvcmRSZWxhdGlvblwiKSk7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi9Nb2RlbFwiKSk7XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3NyYy9pbmRleC50c1xuLy8gbW9kdWxlIGlkID0gMlxuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///2\n");

/***/ }),
/* 3 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = y[op[0] & 2 ? \"return\" : op[0] ? \"throw\" : \"next\"]) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [0, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar ActiveQuery_1 = __webpack_require__(1);\nvar Model_1 = __webpack_require__(0);\n;\nvar ActiveRecord = /** @class */ (function (_super) {\n    __extends(ActiveRecord, _super);\n    function ActiveRecord(values) {\n        var _this = _super.call(this, values) || this;\n        _this._class.init();\n        _this._initRelations();\n        return _this;\n    }\n    Object.defineProperty(ActiveRecord, \"db\", {\n        get: function () {\n            return this._db[this.config.tableName];\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ActiveRecord.prototype, \"db\", {\n        get: function () {\n            return this._class.db[this._class.config.tableName];\n        },\n        enumerable: true,\n        configurable: true\n    });\n    ActiveRecord._dbInit = function () {\n        this.initialized(this.config.tableName);\n        return Promise.resolve(true);\n    };\n    ActiveRecord.initialized = function (model) {\n        this._initialized[model] = true;\n    };\n    Object.defineProperty(ActiveRecord, \"config\", {\n        get: function () {\n            return this._config[this._tableName];\n        },\n        set: function (config) {\n            var _this = this;\n            Object.keys(config).forEach(function (key) {\n                _this._config[key] = config[key];\n            });\n        },\n        enumerable: true,\n        configurable: true\n    });\n    ActiveRecord.init = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                if (this._initialized[this._tableName]) {\n                    return [2 /*return*/];\n                }\n                this._config[this._tableName] = {\n                    identifier: this._identifier || this._defaultConfig.identifier,\n                    tableName: this._tableName || this._defaultConfig.tableName,\n                    queryClass: this._queryClass || this._defaultConfig.queryClass\n                };\n                return [2 /*return*/, this._dbInit()];\n            });\n        });\n    };\n    ActiveRecord.prototype._initRelations = function () {\n        var _this = this;\n        this._class._relations.forEach(function (relation) { return relation.init(_this); });\n    };\n    ActiveRecord.addRelation = function (relation) {\n        this._relations.push(relation);\n    };\n    Object.defineProperty(ActiveRecord.prototype, \"id\", {\n        /* Easy access getter */\n        get: function () {\n            return this.getAttribute(this._class.config.identifier);\n        },\n        set: function (value) {\n            if (!this.id) {\n                this.setAttribute(this._class.config.identifier, value);\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ActiveRecord.prototype, \"isNewRecord\", {\n        get: function () {\n            return !this.id;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /* Querying methods */\n    ActiveRecord.find = function () {\n        this.init();\n        return new this.config.queryClass(this);\n    };\n    ActiveRecord.findOne = function (condition) {\n        if (condition === void 0) { condition = {}; }\n        this.init();\n        // condition is id\n        if (typeof condition === 'string') {\n            var idCondition = {};\n            idCondition[this.config.identifier] = condition;\n            return this.find()\n                .where(idCondition)\n                .one();\n        }\n        return this.find()\n            .where(condition)\n            .one();\n    };\n    ActiveRecord.findAll = function (condition) {\n        if (condition === void 0) { condition = {}; }\n        return this.find()\n            .where(condition)\n            .all();\n    };\n    ActiveRecord.save = function (objects) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                throw new Error('Model.save() needs to be set!');\n            });\n        });\n    };\n    ;\n    ActiveRecord._relations = [];\n    ActiveRecord._defaultConfig = {\n        identifier: 'id',\n        tableName: 'ActiveRecord',\n        queryClass: ActiveQuery_1.ActiveQuery\n    };\n    ActiveRecord._config = {};\n    ActiveRecord._db = {};\n    ActiveRecord._initialized = {};\n    return ActiveRecord;\n}(Model_1.Model));\nexports.ActiveRecord = ActiveRecord;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL3NyYy9BY3RpdmVSZWNvcmQudHM/NzFkNiJdLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcbnZhciBfX2V4dGVuZHMgPSAodGhpcyAmJiB0aGlzLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxuICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XG4gICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9O1xuICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cbiAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xuICAgIH07XG59KSgpO1xudmFyIF9fYXdhaXRlciA9ICh0aGlzICYmIHRoaXMuX19hd2FpdGVyKSB8fCBmdW5jdGlvbiAodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7XG4gICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7IHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZShyZXN1bHQudmFsdWUpOyB9KS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOyB9XG4gICAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTtcbiAgICB9KTtcbn07XG52YXIgX19nZW5lcmF0b3IgPSAodGhpcyAmJiB0aGlzLl9fZ2VuZXJhdG9yKSB8fCBmdW5jdGlvbiAodGhpc0FyZywgYm9keSkge1xuICAgIHZhciBfID0geyBsYWJlbDogMCwgc2VudDogZnVuY3Rpb24oKSB7IGlmICh0WzBdICYgMSkgdGhyb3cgdFsxXTsgcmV0dXJuIHRbMV07IH0sIHRyeXM6IFtdLCBvcHM6IFtdIH0sIGYsIHksIHQsIGc7XG4gICAgcmV0dXJuIGcgPSB7IG5leHQ6IHZlcmIoMCksIFwidGhyb3dcIjogdmVyYigxKSwgXCJyZXR1cm5cIjogdmVyYigyKSB9LCB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgKGdbU3ltYm9sLml0ZXJhdG9yXSA9IGZ1bmN0aW9uKCkgeyByZXR1cm4gdGhpczsgfSksIGc7XG4gICAgZnVuY3Rpb24gdmVyYihuKSB7IHJldHVybiBmdW5jdGlvbiAodikgeyByZXR1cm4gc3RlcChbbiwgdl0pOyB9OyB9XG4gICAgZnVuY3Rpb24gc3RlcChvcCkge1xuICAgICAgICBpZiAoZikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkdlbmVyYXRvciBpcyBhbHJlYWR5IGV4ZWN1dGluZy5cIik7XG4gICAgICAgIHdoaWxlIChfKSB0cnkge1xuICAgICAgICAgICAgaWYgKGYgPSAxLCB5ICYmICh0ID0geVtvcFswXSAmIDIgPyBcInJldHVyblwiIDogb3BbMF0gPyBcInRocm93XCIgOiBcIm5leHRcIl0pICYmICEodCA9IHQuY2FsbCh5LCBvcFsxXSkpLmRvbmUpIHJldHVybiB0O1xuICAgICAgICAgICAgaWYgKHkgPSAwLCB0KSBvcCA9IFswLCB0LnZhbHVlXTtcbiAgICAgICAgICAgIHN3aXRjaCAob3BbMF0pIHtcbiAgICAgICAgICAgICAgICBjYXNlIDA6IGNhc2UgMTogdCA9IG9wOyBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIDQ6IF8ubGFiZWwrKzsgcmV0dXJuIHsgdmFsdWU6IG9wWzFdLCBkb25lOiBmYWxzZSB9O1xuICAgICAgICAgICAgICAgIGNhc2UgNTogXy5sYWJlbCsrOyB5ID0gb3BbMV07IG9wID0gWzBdOyBjb250aW51ZTtcbiAgICAgICAgICAgICAgICBjYXNlIDc6IG9wID0gXy5vcHMucG9wKCk7IF8udHJ5cy5wb3AoKTsgY29udGludWU7XG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEodCA9IF8udHJ5cywgdCA9IHQubGVuZ3RoID4gMCAmJiB0W3QubGVuZ3RoIC0gMV0pICYmIChvcFswXSA9PT0gNiB8fCBvcFswXSA9PT0gMikpIHsgXyA9IDA7IGNvbnRpbnVlOyB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChvcFswXSA9PT0gMyAmJiAoIXQgfHwgKG9wWzFdID4gdFswXSAmJiBvcFsxXSA8IHRbM10pKSkgeyBfLmxhYmVsID0gb3BbMV07IGJyZWFrOyB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChvcFswXSA9PT0gNiAmJiBfLmxhYmVsIDwgdFsxXSkgeyBfLmxhYmVsID0gdFsxXTsgdCA9IG9wOyBicmVhazsgfVxuICAgICAgICAgICAgICAgICAgICBpZiAodCAmJiBfLmxhYmVsIDwgdFsyXSkgeyBfLmxhYmVsID0gdFsyXTsgXy5vcHMucHVzaChvcCk7IGJyZWFrOyB9XG4gICAgICAgICAgICAgICAgICAgIGlmICh0WzJdKSBfLm9wcy5wb3AoKTtcbiAgICAgICAgICAgICAgICAgICAgXy50cnlzLnBvcCgpOyBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG9wID0gYm9keS5jYWxsKHRoaXNBcmcsIF8pO1xuICAgICAgICB9IGNhdGNoIChlKSB7IG9wID0gWzYsIGVdOyB5ID0gMDsgfSBmaW5hbGx5IHsgZiA9IHQgPSAwOyB9XG4gICAgICAgIGlmIChvcFswXSAmIDUpIHRocm93IG9wWzFdOyByZXR1cm4geyB2YWx1ZTogb3BbMF0gPyBvcFsxXSA6IHZvaWQgMCwgZG9uZTogdHJ1ZSB9O1xuICAgIH1cbn07XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgQWN0aXZlUXVlcnlfMSA9IHJlcXVpcmUoXCIuL0FjdGl2ZVF1ZXJ5XCIpO1xudmFyIE1vZGVsXzEgPSByZXF1aXJlKFwiLi9Nb2RlbFwiKTtcbjtcbnZhciBBY3RpdmVSZWNvcmQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKEFjdGl2ZVJlY29yZCwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBBY3RpdmVSZWNvcmQodmFsdWVzKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIHZhbHVlcykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuX2NsYXNzLmluaXQoKTtcbiAgICAgICAgX3RoaXMuX2luaXRSZWxhdGlvbnMoKTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQWN0aXZlUmVjb3JkLCBcImRiXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fZGJbdGhpcy5jb25maWcudGFibGVOYW1lXTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEFjdGl2ZVJlY29yZC5wcm90b3R5cGUsIFwiZGJcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9jbGFzcy5kYlt0aGlzLl9jbGFzcy5jb25maWcudGFibGVOYW1lXTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgQWN0aXZlUmVjb3JkLl9kYkluaXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuaW5pdGlhbGl6ZWQodGhpcy5jb25maWcudGFibGVOYW1lKTtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh0cnVlKTtcbiAgICB9O1xuICAgIEFjdGl2ZVJlY29yZC5pbml0aWFsaXplZCA9IGZ1bmN0aW9uIChtb2RlbCkge1xuICAgICAgICB0aGlzLl9pbml0aWFsaXplZFttb2RlbF0gPSB0cnVlO1xuICAgIH07XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEFjdGl2ZVJlY29yZCwgXCJjb25maWdcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9jb25maWdbdGhpcy5fdGFibGVOYW1lXTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAoY29uZmlnKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICAgICAgT2JqZWN0LmtleXMoY29uZmlnKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHtcbiAgICAgICAgICAgICAgICBfdGhpcy5fY29uZmlnW2tleV0gPSBjb25maWdba2V5XTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBBY3RpdmVSZWNvcmQuaW5pdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9pbml0aWFsaXplZFt0aGlzLl90YWJsZU5hbWVdKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5fY29uZmlnW3RoaXMuX3RhYmxlTmFtZV0gPSB7XG4gICAgICAgICAgICAgICAgICAgIGlkZW50aWZpZXI6IHRoaXMuX2lkZW50aWZpZXIgfHwgdGhpcy5fZGVmYXVsdENvbmZpZy5pZGVudGlmaWVyLFxuICAgICAgICAgICAgICAgICAgICB0YWJsZU5hbWU6IHRoaXMuX3RhYmxlTmFtZSB8fCB0aGlzLl9kZWZhdWx0Q29uZmlnLnRhYmxlTmFtZSxcbiAgICAgICAgICAgICAgICAgICAgcXVlcnlDbGFzczogdGhpcy5fcXVlcnlDbGFzcyB8fCB0aGlzLl9kZWZhdWx0Q29uZmlnLnF1ZXJ5Q2xhc3NcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCB0aGlzLl9kYkluaXQoKV07XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBBY3RpdmVSZWNvcmQucHJvdG90eXBlLl9pbml0UmVsYXRpb25zID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB0aGlzLl9jbGFzcy5fcmVsYXRpb25zLmZvckVhY2goZnVuY3Rpb24gKHJlbGF0aW9uKSB7IHJldHVybiByZWxhdGlvbi5pbml0KF90aGlzKTsgfSk7XG4gICAgfTtcbiAgICBBY3RpdmVSZWNvcmQuYWRkUmVsYXRpb24gPSBmdW5jdGlvbiAocmVsYXRpb24pIHtcbiAgICAgICAgdGhpcy5fcmVsYXRpb25zLnB1c2gocmVsYXRpb24pO1xuICAgIH07XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEFjdGl2ZVJlY29yZC5wcm90b3R5cGUsIFwiaWRcIiwge1xuICAgICAgICAvKiBFYXN5IGFjY2VzcyBnZXR0ZXIgKi9cbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRBdHRyaWJ1dGUodGhpcy5fY2xhc3MuY29uZmlnLmlkZW50aWZpZXIpO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLmlkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRBdHRyaWJ1dGUodGhpcy5fY2xhc3MuY29uZmlnLmlkZW50aWZpZXIsIHZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEFjdGl2ZVJlY29yZC5wcm90b3R5cGUsIFwiaXNOZXdSZWNvcmRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiAhdGhpcy5pZDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgLyogUXVlcnlpbmcgbWV0aG9kcyAqL1xuICAgIEFjdGl2ZVJlY29yZC5maW5kID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmluaXQoKTtcbiAgICAgICAgcmV0dXJuIG5ldyB0aGlzLmNvbmZpZy5xdWVyeUNsYXNzKHRoaXMpO1xuICAgIH07XG4gICAgQWN0aXZlUmVjb3JkLmZpbmRPbmUgPSBmdW5jdGlvbiAoY29uZGl0aW9uKSB7XG4gICAgICAgIGlmIChjb25kaXRpb24gPT09IHZvaWQgMCkgeyBjb25kaXRpb24gPSB7fTsgfVxuICAgICAgICB0aGlzLmluaXQoKTtcbiAgICAgICAgLy8gY29uZGl0aW9uIGlzIGlkXG4gICAgICAgIGlmICh0eXBlb2YgY29uZGl0aW9uID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgdmFyIGlkQ29uZGl0aW9uID0ge307XG4gICAgICAgICAgICBpZENvbmRpdGlvblt0aGlzLmNvbmZpZy5pZGVudGlmaWVyXSA9IGNvbmRpdGlvbjtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmZpbmQoKVxuICAgICAgICAgICAgICAgIC53aGVyZShpZENvbmRpdGlvbilcbiAgICAgICAgICAgICAgICAub25lKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuZmluZCgpXG4gICAgICAgICAgICAud2hlcmUoY29uZGl0aW9uKVxuICAgICAgICAgICAgLm9uZSgpO1xuICAgIH07XG4gICAgQWN0aXZlUmVjb3JkLmZpbmRBbGwgPSBmdW5jdGlvbiAoY29uZGl0aW9uKSB7XG4gICAgICAgIGlmIChjb25kaXRpb24gPT09IHZvaWQgMCkgeyBjb25kaXRpb24gPSB7fTsgfVxuICAgICAgICByZXR1cm4gdGhpcy5maW5kKClcbiAgICAgICAgICAgIC53aGVyZShjb25kaXRpb24pXG4gICAgICAgICAgICAuYWxsKCk7XG4gICAgfTtcbiAgICBBY3RpdmVSZWNvcmQuc2F2ZSA9IGZ1bmN0aW9uIChvYmplY3RzKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ01vZGVsLnNhdmUoKSBuZWVkcyB0byBiZSBzZXQhJyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICA7XG4gICAgQWN0aXZlUmVjb3JkLl9yZWxhdGlvbnMgPSBbXTtcbiAgICBBY3RpdmVSZWNvcmQuX2RlZmF1bHRDb25maWcgPSB7XG4gICAgICAgIGlkZW50aWZpZXI6ICdpZCcsXG4gICAgICAgIHRhYmxlTmFtZTogJ0FjdGl2ZVJlY29yZCcsXG4gICAgICAgIHF1ZXJ5Q2xhc3M6IEFjdGl2ZVF1ZXJ5XzEuQWN0aXZlUXVlcnlcbiAgICB9O1xuICAgIEFjdGl2ZVJlY29yZC5fY29uZmlnID0ge307XG4gICAgQWN0aXZlUmVjb3JkLl9kYiA9IHt9O1xuICAgIEFjdGl2ZVJlY29yZC5faW5pdGlhbGl6ZWQgPSB7fTtcbiAgICByZXR1cm4gQWN0aXZlUmVjb3JkO1xufShNb2RlbF8xLk1vZGVsKSk7XG5leHBvcnRzLkFjdGl2ZVJlY29yZCA9IEFjdGl2ZVJlY29yZDtcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vc3JjL0FjdGl2ZVJlY29yZC50c1xuLy8gbW9kdWxlIGlkID0gM1xuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///3\n");

/***/ }),
/* 4 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = y[op[0] & 2 ? \"return\" : op[0] ? \"throw\" : \"next\"]) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [0, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Model_1 = __webpack_require__(0);\nvar ActiveRecordRelationType = {\n    HasOne: 1,\n    HasMany: 2,\n    ManyToMany: 3\n};\nvar ActiveRecordRelation = /** @class */ (function () {\n    function ActiveRecordRelation(values, attributes) {\n        this._child = values._child;\n        this._foreignKey = values._foreignKey;\n        this._intermediate = values._intermediate;\n        this._key = values._key;\n        this._label = this._formatLabel(values._label);\n        this._property = values._property;\n        this._type = values._type;\n    }\n    ActiveRecordRelation.prototype._formatLabel = function (string) {\n        var singular = string[string.length - 1] === 's' ? string.substr(0, string.length - 1) : string;\n        var plural = string[string.length - 1] === 's' ? string : string + 's';\n        return {\n            original: string,\n            singular: singular,\n            plural: plural,\n            capitalizedSingular: singular[0].toUpperCase() + singular.slice(1),\n            capitalizedPlural: plural[0].toUpperCase() + plural.slice(1)\n        };\n    };\n    ActiveRecordRelation.hasOne = function (label, child, property) {\n        return new this({\n            _child: child,\n            _label: label,\n            _property: property,\n            _type: ActiveRecordRelationType.HasOne\n        });\n    };\n    ActiveRecordRelation.hasMany = function (label, child, property) {\n        return new this({\n            _child: child,\n            _label: label,\n            _property: property,\n            _type: ActiveRecordRelationType.HasMany\n        });\n    };\n    ActiveRecordRelation.manyToMany = function (label, child, intermediate, key, foreignKey) {\n        return new this({\n            _child: child,\n            _foreignKey: foreignKey,\n            _intermediate: intermediate,\n            _key: key,\n            _label: label,\n            _type: ActiveRecordRelationType.ManyToMany\n        });\n    };\n    ActiveRecordRelation.prototype.init = function (model) {\n        var condition = {};\n        if (this._type === ActiveRecordRelationType.HasOne) {\n            this._initHasOne(model, condition);\n        }\n        else if (this._type === ActiveRecordRelationType.HasMany) {\n            this._initHasMany(model, condition);\n        }\n        else if (this._type === ActiveRecordRelationType.ManyToMany) {\n            this._initManyToMany(model, condition);\n        }\n    };\n    ActiveRecordRelation.prototype._initHasOne = function (model, condition) {\n        var _this = this;\n        // add property to class\n        var attribute = new Model_1.ModelAttribute(this._property, 'string');\n        model.class.addAttributes([attribute]);\n        attribute.init(model);\n        model.setAttribute(this._property, model.getAttribute(this._property) || null);\n        if (!model.hasOwnProperty(this._label.original)) {\n            Object.defineProperty(model, this._label.original, {\n                get: function () { return _this._child.findOne(model.getAttribute(_this._property)); },\n            });\n        }\n        if (!model.hasOwnProperty(this._property)) {\n            Object.defineProperty(model, this._property, {\n                get: function () { return model.getAttribute(_this._property); },\n            });\n        }\n        // add `setChild()` method\n        model['set' + this._label.capitalizedSingular] = function (object) { return __awaiter(_this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (!(object instanceof this._child)) {\n                            object = new this._child(object);\n                        }\n                        return [4 /*yield*/, object.save()];\n                    case 1:\n                        _a.sent();\n                        model.setAttribute(this._property, object.getAttribute(this._child.config.identifier));\n                        return [2 /*return*/, object];\n                }\n            });\n        }); };\n    };\n    ActiveRecordRelation.prototype._initHasMany = function (model, condition) {\n        var _this = this;\n        // add foreign property to child class\n        var attribute = new Model_1.ModelAttribute(this._property, 'foreignKey');\n        this._child.addAttributes([attribute]);\n        attribute.init(model);\n        // set getter `children` property\n        Object.defineProperty(model, this._label.plural, {\n            get: function () { return __awaiter(_this, void 0, void 0, function () {\n                return __generator(this, function (_a) {\n                    switch (_a.label) {\n                        case 0: return [4 /*yield*/, this._child.init()];\n                        case 1:\n                            _a.sent();\n                            condition[this._property] = model.getAttribute(this._child.config.identifier);\n                            return [4 /*yield*/, new model.class.config.queryClass(this._child).where(condition).all()];\n                        case 2: return [2 /*return*/, _a.sent()];\n                    }\n                });\n            }); },\n        });\n        // add `getChild()` method\n        model['get' + this._label.capitalizedPlural] = function () { return __awaiter(_this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        condition[this._property] = model.getAttribute(this._child.config.identifier);\n                        return [4 /*yield*/, new model.class.config.queryClass(this._child).where(condition)];\n                    case 1: return [2 /*return*/, _a.sent()];\n                }\n            });\n        }); };\n        // add `addChild()` method\n        model['add' + this._label.capitalizedSingular] = function (object) { return __awaiter(_this, void 0, void 0, function () {\n            var res;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, model['add' + this._label.capitalizedPlural]([object])];\n                    case 1:\n                        res = _a.sent();\n                        return [2 /*return*/, res[0]];\n                }\n            });\n        }); };\n        // add `addChildren()` method\n        model['add' + this._label.capitalizedPlural] = function (objects) { return __awaiter(_this, void 0, void 0, function () {\n            var _this = this;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (!objects.length) {\n                            return [2 /*return*/];\n                        }\n                        // set parent model id in children models\n                        objects = objects.map(function (object) {\n                            object[_this._property] = model.getAttribute(_this._child.config.identifier);\n                            return object;\n                        });\n                        return [4 /*yield*/, this._child.save(objects)];\n                    case 1: \n                    // save all objects\n                    return [2 /*return*/, _a.sent()];\n                }\n            });\n        }); };\n    };\n    ActiveRecordRelation.prototype._initManyToMany = function (model, condition) {\n        var _this = this;\n        // add foreign property to intermediate class\n        var attribute = new Model_1.ModelAttribute(this._foreignKey, 'foreignKey');\n        this._intermediate.addAttributes([attribute]);\n        attribute.init(model);\n        // set getter `children` property\n        if (!model.hasOwnProperty(this._label.plural)) {\n            Object.defineProperty(model, this._label.plural, {\n                get: function () { return __awaiter(_this, void 0, void 0, function () {\n                    var _this = this;\n                    var res, ids, queryCondition;\n                    return __generator(this, function (_a) {\n                        switch (_a.label) {\n                            case 0: return [4 /*yield*/, this._child.init()];\n                            case 1:\n                                _a.sent();\n                                condition[this._key] = model.getAttribute(model.class.config.identifier);\n                                return [4 /*yield*/, this._intermediate.find()\n                                        .where(condition)\n                                        .fields([this._foreignKey])\n                                        .all(false)];\n                            case 2:\n                                res = _a.sent();\n                                if (!res.length) {\n                                    return [2 /*return*/, []];\n                                }\n                                ids = res.map(function (doc) { return doc.getAttribute(_this._foreignKey); }).filter(Boolean);\n                                queryCondition = {};\n                                queryCondition[this._child.config.identifier] = { $in: ids };\n                                return [4 /*yield*/, new model.class.config.queryClass(this._child)\n                                        .where(queryCondition)\n                                        .all()];\n                            case 3: return [2 /*return*/, _a.sent()];\n                        }\n                    });\n                }); }\n            });\n        }\n        // add `getChild()` method\n        model['get' + this._label.capitalizedPlural] = function () { return __awaiter(_this, void 0, void 0, function () {\n            var _this = this;\n            var res, ids, queryCondition;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        condition[this._key] = model.getAttribute(this._child.config.identifier);\n                        return [4 /*yield*/, this._intermediate.find()\n                                .where(condition)\n                                .fields([this._foreignKey])\n                                .all(false)];\n                    case 1:\n                        res = _a.sent();\n                        if (!res.length) {\n                            return [2 /*return*/, []];\n                        }\n                        ids = res.map(function (doc) { return doc.getAttribute(_this._foreignKey); }).filter(Boolean);\n                        queryCondition = {};\n                        queryCondition[this._child.config.identifier] = { $in: ids };\n                        return [4 /*yield*/, new model.class.config.queryClass(this._child)\n                                .where(queryCondition)];\n                    case 2: return [2 /*return*/, _a.sent()];\n                }\n            });\n        }); };\n        // add `addChild()` method\n        model['add' + this._label.capitalizedSingular] = function (object) { return __awaiter(_this, void 0, void 0, function () {\n            var res;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, model['add' + this._label.capitalizedPlural]([object])];\n                    case 1:\n                        res = _a.sent();\n                        return [2 /*return*/, res[0]];\n                }\n            });\n        }); };\n        // add `addChildren()` method\n        model['add' + this._label.capitalizedPlural] = function (objects) { return __awaiter(_this, void 0, void 0, function () {\n            var _this = this;\n            var savedObjects, condition, existingRelations, _loop_1, this_1, found, _i, savedObjects_1, object;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (!objects.length) {\n                            return [2 /*return*/];\n                        }\n                        return [4 /*yield*/, this._child.save(objects)];\n                    case 1:\n                        savedObjects = _a.sent();\n                        condition = {};\n                        condition[this._foreignKey] = { $in: savedObjects.map(function (object) { return object.getAttribute(_this._child.config.identifier); }) };\n                        return [4 /*yield*/, this._intermediate.findAll(condition)];\n                    case 2:\n                        existingRelations = _a.sent();\n                        _loop_1 = function (object) {\n                            var data, relation;\n                            return __generator(this, function (_a) {\n                                switch (_a.label) {\n                                    case 0:\n                                        found = false;\n                                        if (existingRelations.length) {\n                                            existingRelations.forEach(function (existing) {\n                                                found = found || object.getAttribute(_this._child.config.identifier) === existing.getAttribute(_this._foreignKey);\n                                            });\n                                        }\n                                        if (!!found) return [3 /*break*/, 2];\n                                        data = {};\n                                        data[this_1._key] = model.getAttribute(this_1._child.config.identifier);\n                                        data[this_1._foreignKey] = object.getAttribute(this_1._child.config.identifier);\n                                        relation = new this_1._intermediate(data);\n                                        return [4 /*yield*/, relation.save()];\n                                    case 1:\n                                        _a.sent();\n                                        _a.label = 2;\n                                    case 2: return [2 /*return*/];\n                                }\n                            });\n                        };\n                        this_1 = this;\n                        _i = 0, savedObjects_1 = savedObjects;\n                        _a.label = 3;\n                    case 3:\n                        if (!(_i < savedObjects_1.length)) return [3 /*break*/, 6];\n                        object = savedObjects_1[_i];\n                        return [5 /*yield**/, _loop_1(object)];\n                    case 4:\n                        _a.sent();\n                        _a.label = 5;\n                    case 5:\n                        _i++;\n                        return [3 /*break*/, 3];\n                    case 6: return [2 /*return*/, savedObjects];\n                }\n            });\n        }); };\n    };\n    return ActiveRecordRelation;\n}());\nexports.ActiveRecordRelation = ActiveRecordRelation;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNC5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL3NyYy9BY3RpdmVSZWNvcmRSZWxhdGlvbi50cz9kMDRkIl0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xudmFyIF9fYXdhaXRlciA9ICh0aGlzICYmIHRoaXMuX19hd2FpdGVyKSB8fCBmdW5jdGlvbiAodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7XG4gICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7IHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZShyZXN1bHQudmFsdWUpOyB9KS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOyB9XG4gICAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTtcbiAgICB9KTtcbn07XG52YXIgX19nZW5lcmF0b3IgPSAodGhpcyAmJiB0aGlzLl9fZ2VuZXJhdG9yKSB8fCBmdW5jdGlvbiAodGhpc0FyZywgYm9keSkge1xuICAgIHZhciBfID0geyBsYWJlbDogMCwgc2VudDogZnVuY3Rpb24oKSB7IGlmICh0WzBdICYgMSkgdGhyb3cgdFsxXTsgcmV0dXJuIHRbMV07IH0sIHRyeXM6IFtdLCBvcHM6IFtdIH0sIGYsIHksIHQsIGc7XG4gICAgcmV0dXJuIGcgPSB7IG5leHQ6IHZlcmIoMCksIFwidGhyb3dcIjogdmVyYigxKSwgXCJyZXR1cm5cIjogdmVyYigyKSB9LCB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgKGdbU3ltYm9sLml0ZXJhdG9yXSA9IGZ1bmN0aW9uKCkgeyByZXR1cm4gdGhpczsgfSksIGc7XG4gICAgZnVuY3Rpb24gdmVyYihuKSB7IHJldHVybiBmdW5jdGlvbiAodikgeyByZXR1cm4gc3RlcChbbiwgdl0pOyB9OyB9XG4gICAgZnVuY3Rpb24gc3RlcChvcCkge1xuICAgICAgICBpZiAoZikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkdlbmVyYXRvciBpcyBhbHJlYWR5IGV4ZWN1dGluZy5cIik7XG4gICAgICAgIHdoaWxlIChfKSB0cnkge1xuICAgICAgICAgICAgaWYgKGYgPSAxLCB5ICYmICh0ID0geVtvcFswXSAmIDIgPyBcInJldHVyblwiIDogb3BbMF0gPyBcInRocm93XCIgOiBcIm5leHRcIl0pICYmICEodCA9IHQuY2FsbCh5LCBvcFsxXSkpLmRvbmUpIHJldHVybiB0O1xuICAgICAgICAgICAgaWYgKHkgPSAwLCB0KSBvcCA9IFswLCB0LnZhbHVlXTtcbiAgICAgICAgICAgIHN3aXRjaCAob3BbMF0pIHtcbiAgICAgICAgICAgICAgICBjYXNlIDA6IGNhc2UgMTogdCA9IG9wOyBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIDQ6IF8ubGFiZWwrKzsgcmV0dXJuIHsgdmFsdWU6IG9wWzFdLCBkb25lOiBmYWxzZSB9O1xuICAgICAgICAgICAgICAgIGNhc2UgNTogXy5sYWJlbCsrOyB5ID0gb3BbMV07IG9wID0gWzBdOyBjb250aW51ZTtcbiAgICAgICAgICAgICAgICBjYXNlIDc6IG9wID0gXy5vcHMucG9wKCk7IF8udHJ5cy5wb3AoKTsgY29udGludWU7XG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEodCA9IF8udHJ5cywgdCA9IHQubGVuZ3RoID4gMCAmJiB0W3QubGVuZ3RoIC0gMV0pICYmIChvcFswXSA9PT0gNiB8fCBvcFswXSA9PT0gMikpIHsgXyA9IDA7IGNvbnRpbnVlOyB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChvcFswXSA9PT0gMyAmJiAoIXQgfHwgKG9wWzFdID4gdFswXSAmJiBvcFsxXSA8IHRbM10pKSkgeyBfLmxhYmVsID0gb3BbMV07IGJyZWFrOyB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChvcFswXSA9PT0gNiAmJiBfLmxhYmVsIDwgdFsxXSkgeyBfLmxhYmVsID0gdFsxXTsgdCA9IG9wOyBicmVhazsgfVxuICAgICAgICAgICAgICAgICAgICBpZiAodCAmJiBfLmxhYmVsIDwgdFsyXSkgeyBfLmxhYmVsID0gdFsyXTsgXy5vcHMucHVzaChvcCk7IGJyZWFrOyB9XG4gICAgICAgICAgICAgICAgICAgIGlmICh0WzJdKSBfLm9wcy5wb3AoKTtcbiAgICAgICAgICAgICAgICAgICAgXy50cnlzLnBvcCgpOyBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG9wID0gYm9keS5jYWxsKHRoaXNBcmcsIF8pO1xuICAgICAgICB9IGNhdGNoIChlKSB7IG9wID0gWzYsIGVdOyB5ID0gMDsgfSBmaW5hbGx5IHsgZiA9IHQgPSAwOyB9XG4gICAgICAgIGlmIChvcFswXSAmIDUpIHRocm93IG9wWzFdOyByZXR1cm4geyB2YWx1ZTogb3BbMF0gPyBvcFsxXSA6IHZvaWQgMCwgZG9uZTogdHJ1ZSB9O1xuICAgIH1cbn07XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgTW9kZWxfMSA9IHJlcXVpcmUoXCIuL01vZGVsXCIpO1xudmFyIEFjdGl2ZVJlY29yZFJlbGF0aW9uVHlwZSA9IHtcbiAgICBIYXNPbmU6IDEsXG4gICAgSGFzTWFueTogMixcbiAgICBNYW55VG9NYW55OiAzXG59O1xudmFyIEFjdGl2ZVJlY29yZFJlbGF0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIEFjdGl2ZVJlY29yZFJlbGF0aW9uKHZhbHVlcywgYXR0cmlidXRlcykge1xuICAgICAgICB0aGlzLl9jaGlsZCA9IHZhbHVlcy5fY2hpbGQ7XG4gICAgICAgIHRoaXMuX2ZvcmVpZ25LZXkgPSB2YWx1ZXMuX2ZvcmVpZ25LZXk7XG4gICAgICAgIHRoaXMuX2ludGVybWVkaWF0ZSA9IHZhbHVlcy5faW50ZXJtZWRpYXRlO1xuICAgICAgICB0aGlzLl9rZXkgPSB2YWx1ZXMuX2tleTtcbiAgICAgICAgdGhpcy5fbGFiZWwgPSB0aGlzLl9mb3JtYXRMYWJlbCh2YWx1ZXMuX2xhYmVsKTtcbiAgICAgICAgdGhpcy5fcHJvcGVydHkgPSB2YWx1ZXMuX3Byb3BlcnR5O1xuICAgICAgICB0aGlzLl90eXBlID0gdmFsdWVzLl90eXBlO1xuICAgIH1cbiAgICBBY3RpdmVSZWNvcmRSZWxhdGlvbi5wcm90b3R5cGUuX2Zvcm1hdExhYmVsID0gZnVuY3Rpb24gKHN0cmluZykge1xuICAgICAgICB2YXIgc2luZ3VsYXIgPSBzdHJpbmdbc3RyaW5nLmxlbmd0aCAtIDFdID09PSAncycgPyBzdHJpbmcuc3Vic3RyKDAsIHN0cmluZy5sZW5ndGggLSAxKSA6IHN0cmluZztcbiAgICAgICAgdmFyIHBsdXJhbCA9IHN0cmluZ1tzdHJpbmcubGVuZ3RoIC0gMV0gPT09ICdzJyA/IHN0cmluZyA6IHN0cmluZyArICdzJztcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIG9yaWdpbmFsOiBzdHJpbmcsXG4gICAgICAgICAgICBzaW5ndWxhcjogc2luZ3VsYXIsXG4gICAgICAgICAgICBwbHVyYWw6IHBsdXJhbCxcbiAgICAgICAgICAgIGNhcGl0YWxpemVkU2luZ3VsYXI6IHNpbmd1bGFyWzBdLnRvVXBwZXJDYXNlKCkgKyBzaW5ndWxhci5zbGljZSgxKSxcbiAgICAgICAgICAgIGNhcGl0YWxpemVkUGx1cmFsOiBwbHVyYWxbMF0udG9VcHBlckNhc2UoKSArIHBsdXJhbC5zbGljZSgxKVxuICAgICAgICB9O1xuICAgIH07XG4gICAgQWN0aXZlUmVjb3JkUmVsYXRpb24uaGFzT25lID0gZnVuY3Rpb24gKGxhYmVsLCBjaGlsZCwgcHJvcGVydHkpIHtcbiAgICAgICAgcmV0dXJuIG5ldyB0aGlzKHtcbiAgICAgICAgICAgIF9jaGlsZDogY2hpbGQsXG4gICAgICAgICAgICBfbGFiZWw6IGxhYmVsLFxuICAgICAgICAgICAgX3Byb3BlcnR5OiBwcm9wZXJ0eSxcbiAgICAgICAgICAgIF90eXBlOiBBY3RpdmVSZWNvcmRSZWxhdGlvblR5cGUuSGFzT25lXG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgQWN0aXZlUmVjb3JkUmVsYXRpb24uaGFzTWFueSA9IGZ1bmN0aW9uIChsYWJlbCwgY2hpbGQsIHByb3BlcnR5KSB7XG4gICAgICAgIHJldHVybiBuZXcgdGhpcyh7XG4gICAgICAgICAgICBfY2hpbGQ6IGNoaWxkLFxuICAgICAgICAgICAgX2xhYmVsOiBsYWJlbCxcbiAgICAgICAgICAgIF9wcm9wZXJ0eTogcHJvcGVydHksXG4gICAgICAgICAgICBfdHlwZTogQWN0aXZlUmVjb3JkUmVsYXRpb25UeXBlLkhhc01hbnlcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBBY3RpdmVSZWNvcmRSZWxhdGlvbi5tYW55VG9NYW55ID0gZnVuY3Rpb24gKGxhYmVsLCBjaGlsZCwgaW50ZXJtZWRpYXRlLCBrZXksIGZvcmVpZ25LZXkpIHtcbiAgICAgICAgcmV0dXJuIG5ldyB0aGlzKHtcbiAgICAgICAgICAgIF9jaGlsZDogY2hpbGQsXG4gICAgICAgICAgICBfZm9yZWlnbktleTogZm9yZWlnbktleSxcbiAgICAgICAgICAgIF9pbnRlcm1lZGlhdGU6IGludGVybWVkaWF0ZSxcbiAgICAgICAgICAgIF9rZXk6IGtleSxcbiAgICAgICAgICAgIF9sYWJlbDogbGFiZWwsXG4gICAgICAgICAgICBfdHlwZTogQWN0aXZlUmVjb3JkUmVsYXRpb25UeXBlLk1hbnlUb01hbnlcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBBY3RpdmVSZWNvcmRSZWxhdGlvbi5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uIChtb2RlbCkge1xuICAgICAgICB2YXIgY29uZGl0aW9uID0ge307XG4gICAgICAgIGlmICh0aGlzLl90eXBlID09PSBBY3RpdmVSZWNvcmRSZWxhdGlvblR5cGUuSGFzT25lKSB7XG4gICAgICAgICAgICB0aGlzLl9pbml0SGFzT25lKG1vZGVsLCBjb25kaXRpb24pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHRoaXMuX3R5cGUgPT09IEFjdGl2ZVJlY29yZFJlbGF0aW9uVHlwZS5IYXNNYW55KSB7XG4gICAgICAgICAgICB0aGlzLl9pbml0SGFzTWFueShtb2RlbCwgY29uZGl0aW9uKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0aGlzLl90eXBlID09PSBBY3RpdmVSZWNvcmRSZWxhdGlvblR5cGUuTWFueVRvTWFueSkge1xuICAgICAgICAgICAgdGhpcy5faW5pdE1hbnlUb01hbnkobW9kZWwsIGNvbmRpdGlvbik7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEFjdGl2ZVJlY29yZFJlbGF0aW9uLnByb3RvdHlwZS5faW5pdEhhc09uZSA9IGZ1bmN0aW9uIChtb2RlbCwgY29uZGl0aW9uKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIC8vIGFkZCBwcm9wZXJ0eSB0byBjbGFzc1xuICAgICAgICB2YXIgYXR0cmlidXRlID0gbmV3IE1vZGVsXzEuTW9kZWxBdHRyaWJ1dGUodGhpcy5fcHJvcGVydHksICdzdHJpbmcnKTtcbiAgICAgICAgbW9kZWwuY2xhc3MuYWRkQXR0cmlidXRlcyhbYXR0cmlidXRlXSk7XG4gICAgICAgIGF0dHJpYnV0ZS5pbml0KG1vZGVsKTtcbiAgICAgICAgbW9kZWwuc2V0QXR0cmlidXRlKHRoaXMuX3Byb3BlcnR5LCBtb2RlbC5nZXRBdHRyaWJ1dGUodGhpcy5fcHJvcGVydHkpIHx8IG51bGwpO1xuICAgICAgICBpZiAoIW1vZGVsLmhhc093blByb3BlcnR5KHRoaXMuX2xhYmVsLm9yaWdpbmFsKSkge1xuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG1vZGVsLCB0aGlzLl9sYWJlbC5vcmlnaW5hbCwge1xuICAgICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gKCkgeyByZXR1cm4gX3RoaXMuX2NoaWxkLmZpbmRPbmUobW9kZWwuZ2V0QXR0cmlidXRlKF90aGlzLl9wcm9wZXJ0eSkpOyB9LFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFtb2RlbC5oYXNPd25Qcm9wZXJ0eSh0aGlzLl9wcm9wZXJ0eSkpIHtcbiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShtb2RlbCwgdGhpcy5fcHJvcGVydHksIHtcbiAgICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIG1vZGVsLmdldEF0dHJpYnV0ZShfdGhpcy5fcHJvcGVydHkpOyB9LFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gYWRkIGBzZXRDaGlsZCgpYCBtZXRob2RcbiAgICAgICAgbW9kZWxbJ3NldCcgKyB0aGlzLl9sYWJlbC5jYXBpdGFsaXplZFNpbmd1bGFyXSA9IGZ1bmN0aW9uIChvYmplY3QpIHsgcmV0dXJuIF9fYXdhaXRlcihfdGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKG9iamVjdCBpbnN0YW5jZW9mIHRoaXMuX2NoaWxkKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9iamVjdCA9IG5ldyB0aGlzLl9jaGlsZChvYmplY3QpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgb2JqZWN0LnNhdmUoKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vZGVsLnNldEF0dHJpYnV0ZSh0aGlzLl9wcm9wZXJ0eSwgb2JqZWN0LmdldEF0dHJpYnV0ZSh0aGlzLl9jaGlsZC5jb25maWcuaWRlbnRpZmllcikpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIG9iamVjdF07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pOyB9O1xuICAgIH07XG4gICAgQWN0aXZlUmVjb3JkUmVsYXRpb24ucHJvdG90eXBlLl9pbml0SGFzTWFueSA9IGZ1bmN0aW9uIChtb2RlbCwgY29uZGl0aW9uKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIC8vIGFkZCBmb3JlaWduIHByb3BlcnR5IHRvIGNoaWxkIGNsYXNzXG4gICAgICAgIHZhciBhdHRyaWJ1dGUgPSBuZXcgTW9kZWxfMS5Nb2RlbEF0dHJpYnV0ZSh0aGlzLl9wcm9wZXJ0eSwgJ2ZvcmVpZ25LZXknKTtcbiAgICAgICAgdGhpcy5fY2hpbGQuYWRkQXR0cmlidXRlcyhbYXR0cmlidXRlXSk7XG4gICAgICAgIGF0dHJpYnV0ZS5pbml0KG1vZGVsKTtcbiAgICAgICAgLy8gc2V0IGdldHRlciBgY2hpbGRyZW5gIHByb3BlcnR5XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShtb2RlbCwgdGhpcy5fbGFiZWwucGx1cmFsLCB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIF9fYXdhaXRlcihfdGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDogcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5fY2hpbGQuaW5pdCgpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uZGl0aW9uW3RoaXMuX3Byb3BlcnR5XSA9IG1vZGVsLmdldEF0dHJpYnV0ZSh0aGlzLl9jaGlsZC5jb25maWcuaWRlbnRpZmllcik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgbmV3IG1vZGVsLmNsYXNzLmNvbmZpZy5xdWVyeUNsYXNzKHRoaXMuX2NoaWxkKS53aGVyZShjb25kaXRpb24pLmFsbCgpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMjogcmV0dXJuIFsyIC8qcmV0dXJuKi8sIF9hLnNlbnQoKV07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pOyB9LFxuICAgICAgICB9KTtcbiAgICAgICAgLy8gYWRkIGBnZXRDaGlsZCgpYCBtZXRob2RcbiAgICAgICAgbW9kZWxbJ2dldCcgKyB0aGlzLl9sYWJlbC5jYXBpdGFsaXplZFBsdXJhbF0gPSBmdW5jdGlvbiAoKSB7IHJldHVybiBfX2F3YWl0ZXIoX3RoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25kaXRpb25bdGhpcy5fcHJvcGVydHldID0gbW9kZWwuZ2V0QXR0cmlidXRlKHRoaXMuX2NoaWxkLmNvbmZpZy5pZGVudGlmaWVyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIG5ldyBtb2RlbC5jbGFzcy5jb25maWcucXVlcnlDbGFzcyh0aGlzLl9jaGlsZCkud2hlcmUoY29uZGl0aW9uKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTogcmV0dXJuIFsyIC8qcmV0dXJuKi8sIF9hLnNlbnQoKV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pOyB9O1xuICAgICAgICAvLyBhZGQgYGFkZENoaWxkKClgIG1ldGhvZFxuICAgICAgICBtb2RlbFsnYWRkJyArIHRoaXMuX2xhYmVsLmNhcGl0YWxpemVkU2luZ3VsYXJdID0gZnVuY3Rpb24gKG9iamVjdCkgeyByZXR1cm4gX19hd2FpdGVyKF90aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHJlcztcbiAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDogcmV0dXJuIFs0IC8qeWllbGQqLywgbW9kZWxbJ2FkZCcgKyB0aGlzLl9sYWJlbC5jYXBpdGFsaXplZFBsdXJhbF0oW29iamVjdF0pXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzID0gX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIHJlc1swXV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pOyB9O1xuICAgICAgICAvLyBhZGQgYGFkZENoaWxkcmVuKClgIG1ldGhvZFxuICAgICAgICBtb2RlbFsnYWRkJyArIHRoaXMuX2xhYmVsLmNhcGl0YWxpemVkUGx1cmFsXSA9IGZ1bmN0aW9uIChvYmplY3RzKSB7IHJldHVybiBfX2F3YWl0ZXIoX3RoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICAgICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFvYmplY3RzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNldCBwYXJlbnQgbW9kZWwgaWQgaW4gY2hpbGRyZW4gbW9kZWxzXG4gICAgICAgICAgICAgICAgICAgICAgICBvYmplY3RzID0gb2JqZWN0cy5tYXAoZnVuY3Rpb24gKG9iamVjdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9iamVjdFtfdGhpcy5fcHJvcGVydHldID0gbW9kZWwuZ2V0QXR0cmlidXRlKF90aGlzLl9jaGlsZC5jb25maWcuaWRlbnRpZmllcik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9iamVjdDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5fY2hpbGQuc2F2ZShvYmplY3RzKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTogXG4gICAgICAgICAgICAgICAgICAgIC8vIHNhdmUgYWxsIG9iamVjdHNcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIF9hLnNlbnQoKV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pOyB9O1xuICAgIH07XG4gICAgQWN0aXZlUmVjb3JkUmVsYXRpb24ucHJvdG90eXBlLl9pbml0TWFueVRvTWFueSA9IGZ1bmN0aW9uIChtb2RlbCwgY29uZGl0aW9uKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIC8vIGFkZCBmb3JlaWduIHByb3BlcnR5IHRvIGludGVybWVkaWF0ZSBjbGFzc1xuICAgICAgICB2YXIgYXR0cmlidXRlID0gbmV3IE1vZGVsXzEuTW9kZWxBdHRyaWJ1dGUodGhpcy5fZm9yZWlnbktleSwgJ2ZvcmVpZ25LZXknKTtcbiAgICAgICAgdGhpcy5faW50ZXJtZWRpYXRlLmFkZEF0dHJpYnV0ZXMoW2F0dHJpYnV0ZV0pO1xuICAgICAgICBhdHRyaWJ1dGUuaW5pdChtb2RlbCk7XG4gICAgICAgIC8vIHNldCBnZXR0ZXIgYGNoaWxkcmVuYCBwcm9wZXJ0eVxuICAgICAgICBpZiAoIW1vZGVsLmhhc093blByb3BlcnR5KHRoaXMuX2xhYmVsLnBsdXJhbCkpIHtcbiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShtb2RlbCwgdGhpcy5fbGFiZWwucGx1cmFsLCB7XG4gICAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7IHJldHVybiBfX2F3YWl0ZXIoX3RoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICAgICAgICAgIHZhciByZXMsIGlkcywgcXVlcnlDb25kaXRpb247XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6IHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuX2NoaWxkLmluaXQoKV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbmRpdGlvblt0aGlzLl9rZXldID0gbW9kZWwuZ2V0QXR0cmlidXRlKG1vZGVsLmNsYXNzLmNvbmZpZy5pZGVudGlmaWVyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5faW50ZXJtZWRpYXRlLmZpbmQoKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC53aGVyZShjb25kaXRpb24pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZpZWxkcyhbdGhpcy5fZm9yZWlnbktleV0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmFsbChmYWxzZSldO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzID0gX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXJlcy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCBbXV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWRzID0gcmVzLm1hcChmdW5jdGlvbiAoZG9jKSB7IHJldHVybiBkb2MuZ2V0QXR0cmlidXRlKF90aGlzLl9mb3JlaWduS2V5KTsgfSkuZmlsdGVyKEJvb2xlYW4pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBxdWVyeUNvbmRpdGlvbiA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBxdWVyeUNvbmRpdGlvblt0aGlzLl9jaGlsZC5jb25maWcuaWRlbnRpZmllcl0gPSB7ICRpbjogaWRzIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIG5ldyBtb2RlbC5jbGFzcy5jb25maWcucXVlcnlDbGFzcyh0aGlzLl9jaGlsZClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAud2hlcmUocXVlcnlDb25kaXRpb24pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmFsbCgpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDM6IHJldHVybiBbMiAvKnJldHVybiovLCBfYS5zZW50KCldO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9KTsgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gYWRkIGBnZXRDaGlsZCgpYCBtZXRob2RcbiAgICAgICAgbW9kZWxbJ2dldCcgKyB0aGlzLl9sYWJlbC5jYXBpdGFsaXplZFBsdXJhbF0gPSBmdW5jdGlvbiAoKSB7IHJldHVybiBfX2F3YWl0ZXIoX3RoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICAgICAgdmFyIHJlcywgaWRzLCBxdWVyeUNvbmRpdGlvbjtcbiAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbmRpdGlvblt0aGlzLl9rZXldID0gbW9kZWwuZ2V0QXR0cmlidXRlKHRoaXMuX2NoaWxkLmNvbmZpZy5pZGVudGlmaWVyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuX2ludGVybWVkaWF0ZS5maW5kKClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLndoZXJlKGNvbmRpdGlvbilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZpZWxkcyhbdGhpcy5fZm9yZWlnbktleV0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hbGwoZmFsc2UpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzID0gX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFyZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIFtdXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlkcyA9IHJlcy5tYXAoZnVuY3Rpb24gKGRvYykgeyByZXR1cm4gZG9jLmdldEF0dHJpYnV0ZShfdGhpcy5fZm9yZWlnbktleSk7IH0pLmZpbHRlcihCb29sZWFuKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXJ5Q29uZGl0aW9uID0ge307XG4gICAgICAgICAgICAgICAgICAgICAgICBxdWVyeUNvbmRpdGlvblt0aGlzLl9jaGlsZC5jb25maWcuaWRlbnRpZmllcl0gPSB7ICRpbjogaWRzIH07XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCBuZXcgbW9kZWwuY2xhc3MuY29uZmlnLnF1ZXJ5Q2xhc3ModGhpcy5fY2hpbGQpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC53aGVyZShxdWVyeUNvbmRpdGlvbildO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6IHJldHVybiBbMiAvKnJldHVybiovLCBfYS5zZW50KCldO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTsgfTtcbiAgICAgICAgLy8gYWRkIGBhZGRDaGlsZCgpYCBtZXRob2RcbiAgICAgICAgbW9kZWxbJ2FkZCcgKyB0aGlzLl9sYWJlbC5jYXBpdGFsaXplZFNpbmd1bGFyXSA9IGZ1bmN0aW9uIChvYmplY3QpIHsgcmV0dXJuIF9fYXdhaXRlcihfdGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciByZXM7XG4gICAgICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6IHJldHVybiBbNCAvKnlpZWxkKi8sIG1vZGVsWydhZGQnICsgdGhpcy5fbGFiZWwuY2FwaXRhbGl6ZWRQbHVyYWxdKFtvYmplY3RdKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcyA9IF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCByZXNbMF1dO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTsgfTtcbiAgICAgICAgLy8gYWRkIGBhZGRDaGlsZHJlbigpYCBtZXRob2RcbiAgICAgICAgbW9kZWxbJ2FkZCcgKyB0aGlzLl9sYWJlbC5jYXBpdGFsaXplZFBsdXJhbF0gPSBmdW5jdGlvbiAob2JqZWN0cykgeyByZXR1cm4gX19hd2FpdGVyKF90aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgICAgIHZhciBzYXZlZE9iamVjdHMsIGNvbmRpdGlvbiwgZXhpc3RpbmdSZWxhdGlvbnMsIF9sb29wXzEsIHRoaXNfMSwgZm91bmQsIF9pLCBzYXZlZE9iamVjdHNfMSwgb2JqZWN0O1xuICAgICAgICAgICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFvYmplY3RzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuX2NoaWxkLnNhdmUob2JqZWN0cyldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICBzYXZlZE9iamVjdHMgPSBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25kaXRpb24gPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbmRpdGlvblt0aGlzLl9mb3JlaWduS2V5XSA9IHsgJGluOiBzYXZlZE9iamVjdHMubWFwKGZ1bmN0aW9uIChvYmplY3QpIHsgcmV0dXJuIG9iamVjdC5nZXRBdHRyaWJ1dGUoX3RoaXMuX2NoaWxkLmNvbmZpZy5pZGVudGlmaWVyKTsgfSkgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuX2ludGVybWVkaWF0ZS5maW5kQWxsKGNvbmRpdGlvbildO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgICAgICBleGlzdGluZ1JlbGF0aW9ucyA9IF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9sb29wXzEgPSBmdW5jdGlvbiAob2JqZWN0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRhdGEsIHJlbGF0aW9uO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvdW5kID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV4aXN0aW5nUmVsYXRpb25zLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBleGlzdGluZ1JlbGF0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uIChleGlzdGluZykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm91bmQgPSBmb3VuZCB8fCBvYmplY3QuZ2V0QXR0cmlidXRlKF90aGlzLl9jaGlsZC5jb25maWcuaWRlbnRpZmllcikgPT09IGV4aXN0aW5nLmdldEF0dHJpYnV0ZShfdGhpcy5fZm9yZWlnbktleSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoISFmb3VuZCkgcmV0dXJuIFszIC8qYnJlYWsqLywgMl07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YSA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFbdGhpc18xLl9rZXldID0gbW9kZWwuZ2V0QXR0cmlidXRlKHRoaXNfMS5fY2hpbGQuY29uZmlnLmlkZW50aWZpZXIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFbdGhpc18xLl9mb3JlaWduS2V5XSA9IG9iamVjdC5nZXRBdHRyaWJ1dGUodGhpc18xLl9jaGlsZC5jb25maWcuaWRlbnRpZmllcik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVsYXRpb24gPSBuZXcgdGhpc18xLl9pbnRlcm1lZGlhdGUoZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgcmVsYXRpb24uc2F2ZSgpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2EubGFiZWwgPSAyO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAyOiByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzXzEgPSB0aGlzO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2kgPSAwLCBzYXZlZE9iamVjdHNfMSA9IHNhdmVkT2JqZWN0cztcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLmxhYmVsID0gMztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEoX2kgPCBzYXZlZE9iamVjdHNfMS5sZW5ndGgpKSByZXR1cm4gWzMgLypicmVhayovLCA2XTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG9iamVjdCA9IHNhdmVkT2JqZWN0c18xW19pXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNSAvKnlpZWxkKiovLCBfbG9vcF8xKG9iamVjdCldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5sYWJlbCA9IDU7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNTpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9pKys7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCAzXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA2OiByZXR1cm4gWzIgLypyZXR1cm4qLywgc2F2ZWRPYmplY3RzXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7IH07XG4gICAgfTtcbiAgICByZXR1cm4gQWN0aXZlUmVjb3JkUmVsYXRpb247XG59KCkpO1xuZXhwb3J0cy5BY3RpdmVSZWNvcmRSZWxhdGlvbiA9IEFjdGl2ZVJlY29yZFJlbGF0aW9uO1xuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9zcmMvQWN0aXZlUmVjb3JkUmVsYXRpb24udHNcbi8vIG1vZHVsZSBpZCA9IDRcbi8vIG1vZHVsZSBjaHVua3MgPSAwIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///4\n");

/***/ })
/******/ ])));